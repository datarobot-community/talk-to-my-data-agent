const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./react-plotly-CzsfXI6m.js","./index-DnsQ3JLc.js","./index-B4LBPR0-.css","./ResponseMessage-DhbwFvMo.js","./tabs-DD0yVPep.js","./loading-Dl0zvYh-.js"])))=>i.map(i=>d[i]);
import{u as N,v as Se,w as Ge,x as Ve,y as ue,z,j as t,F as E,n as fe,A as ge,r as h,C as G,E as he,G as ke,P as R,H as pe,J as He,K as Oe,L as ze,k as V,R as P,B as A,c as F,M as k,N as w,O as Be,_ as me,Q as qe,T as Ue,U as Ze,V as $e,W as Ke,X as We,Y as Je,Z as Ye,I as Qe,$ as Xe,a0 as ve,a1 as et,a2 as tt,a3 as at,a4 as st,p as xe,a5 as nt,a6 as rt,q as it,S as ot}from"./index-DnsQ3JLc.js";import{C as be,f as je,b as lt,L as ct,S as dt}from"./loading-Dl0zvYh-.js";var B={},ae;function ut(){return ae||(ae=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="fas",s="file-arrow-down",n=384,r=512,i=["file-download"],l="f56d",o="M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM216 232l0 102.1 31-31c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-72 72c-9.4 9.4-24.6 9.4-33.9 0l-72-72c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l31 31L168 232c0-13.3 10.7-24 24-24s24 10.7 24 24z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faFileArrowDown=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}(B)),B}var Ce=ut();const H=e=>{const{t:a}=N(),{data:s=[],isLoading:n,error:r}=Se({chatId:e}),i=s.some(g=>g.in_progress),l=s.some(g=>g.error),{mutate:o,isPending:u,error:f}=Ge(),{mutate:c,isPending:d,error:p}=Ve(),{exportChat:j,isLoading:C}=ue(),y=g=>{if(g)return s.find(b=>b.id===g)},x=g=>{if(!g)return;const b=y(g);if(!b)return;if(b.role==="assistant")return b;const _=s.findIndex(T=>T.id===g),m=s[_+1];return(m==null?void 0:m.role)==="assistant"?m:void 0};return{messages:s,isLoading:n,isSending:u,isDeleting:d,isExporting:C,hasInProgressMessages:i,hasFailedMessages:l,fetchError:r,sendError:f,deleteError:p,getMessage:y,getResponseMessage:x,sendMessage:(g,b={})=>{if(!g.trim()){z.error(a("Message cannot be empty"));return}o({message:g,chatId:e,enableChartGeneration:b.enableChartGeneration,enableBusinessInsights:b.enableBusinessInsights,dataSource:b.dataSource})},deleteMessagePair:g=>{const b=y(g);if(!b||b.role!=="user"||!b.id)throw new Error("User message not found");const _=x(g);_!=null&&_.id&&_!==b&&c({messageId:_.id,chatId:e}),c({messageId:b.id,chatId:e})},exportMessage:g=>{if(!e){z.error(a("Chat ID not found"));return}if(!g){z.error(a("Message ID not found for export"));return}j({chatId:e,messageId:g})}}};var q={},se;function ft(){return se||(se=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="far",s="comment",n=512,r=512,i=[128489,61669],l="f075",o="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9l.3-.5z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faComment=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}(q)),q}var gt=ft();const ht="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20%3e%3crect%20x='0.682129'%20width='24'%20height='24'%20rx='12'%20fill='%2373FF95'%20/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.93506%205.49414H12.6824V6.93975H5.93506V5.49414ZM16.052%206.93994H12.6783V8.38555H16.052V6.93994ZM5.93506%208.38573H12.6824V9.83134H5.93506V8.38573ZM19.4293%209.83294H16.0556V11.2773H5.93506V12.7229H16.056V11.2786H19.4293V9.83294ZM19.4293%2012.7231H16.0556V14.1687H19.4293V12.7231ZM5.93506%2014.1689H12.6824V15.6145H5.93506V14.1689ZM16.052%2015.6147H12.6783V17.0603H16.052V15.6147ZM12.6824%2017.0605H5.93506V18.5061H12.6824V17.0605Z'%20fill='%23181D21'%20/%3e%3c/svg%3e",pt=()=>{const e=fe();return t.jsx("div",{className:"text-center text-sm font-normal leading-tight text-primary-foreground",children:t.jsx("img",{src:ht,alt:"",className:"cursor-pointer",onClick:()=>e(ge.DATA)})})},mt=()=>t.jsx("div",{className:"w-6 h-6 p-2.5 bg-[#7c97f8] rounded-[100px] flex-col justify-center items-center gap-2.5 inline-flex overflow-hidden",children:t.jsx("div",{className:"text-center text-sm font-normal leading-tight text-primary-foreground",children:t.jsx(E,{icon:gt.faComment})})});var U={},ne;function vt(){return ne||(ne=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="fas",s="chevron-up",n=512,r=512,i=[],l="f077",o="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faChevronUp=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}(U)),U}var xt=vt(),Z={},re;function bt(){return re||(re=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="fas",s="chevron-down",n=512,r=512,i=[],l="f078",o="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faChevronDown=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}(Z)),Z}var jt=bt(),O="Collapsible",[Ct,ia]=he(O),[Pt,J]=Ct(O),Pe=h.forwardRef((e,a)=>{const{__scopeCollapsible:s,open:n,defaultOpen:r,disabled:i,onOpenChange:l,...o}=e,[u,f]=G({prop:n,defaultProp:r??!1,onChange:l,caller:O});return t.jsx(Pt,{scope:s,disabled:i,contentId:ke(),open:u,onOpenToggle:h.useCallback(()=>f(c=>!c),[f]),children:t.jsx(R.div,{"data-state":Q(u),"data-disabled":i?"":void 0,...o,ref:a})})});Pe.displayName=O;var we="CollapsibleTrigger",ye=h.forwardRef((e,a)=>{const{__scopeCollapsible:s,...n}=e,r=J(we,s);return t.jsx(R.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Q(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...n,ref:a,onClick:pe(e.onClick,r.onOpenToggle)})});ye.displayName=we;var Y="CollapsibleContent",Le=h.forwardRef((e,a)=>{const{forceMount:s,...n}=e,r=J(Y,e.__scopeCollapsible);return t.jsx(He,{present:s||r.open,children:({present:i})=>t.jsx(wt,{...n,ref:a,present:i})})});Le.displayName=Y;var wt=h.forwardRef((e,a)=>{const{__scopeCollapsible:s,present:n,children:r,...i}=e,l=J(Y,s),[o,u]=h.useState(n),f=h.useRef(null),c=Oe(a,f),d=h.useRef(0),p=d.current,j=h.useRef(0),C=j.current,y=l.open||o,x=h.useRef(y),L=h.useRef(void 0);return h.useEffect(()=>{const v=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(v)},[]),ze(()=>{const v=f.current;if(v){L.current=L.current||{transitionDuration:v.style.transitionDuration,animationName:v.style.animationName},v.style.transitionDuration="0s",v.style.animationName="none";const M=v.getBoundingClientRect();d.current=M.height,j.current=M.width,x.current||(v.style.transitionDuration=L.current.transitionDuration,v.style.animationName=L.current.animationName),u(n)}},[l.open,n]),t.jsx(R.div,{"data-state":Q(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!y,...i,ref:c,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":C?`${C}px`:void 0,...e.style},children:y&&r})});function Q(e){return e?"open":"closed"}var yt=Pe;function Lt({...e}){return t.jsx(yt,{"data-slot":"collapsible",...e})}function Nt({...e}){return t.jsx(ye,{"data-slot":"collapsible-trigger",...e})}function Mt({...e}){return t.jsx(Le,{"data-slot":"collapsible-content",...e})}const _t=({header:e,children:a,headerActions:s,triggerTestId:n="collapsible-panel-trigger"})=>{const{t:r}=N(),{collapsiblePanelDefaultOpen:i}=V(),[l,o]=P.useState(i);return t.jsxs(Lt,{open:l,onOpenChange:o,className:"rounded border border-border",children:[t.jsx(Nt,{asChild:!0,className:"bg-muted",children:t.jsxs("div",{className:"h-[52px] flex justify-between items-center px-4 cursor-pointer",children:[t.jsx("div",{children:e}),t.jsxs("div",{className:"flex items-center gap-2",children:[s,t.jsx(A,{variant:"ghost",size:"icon",testId:n,"aria-label":r("Toggle panel"),"aria-expanded":l,children:t.jsx(E,{icon:l?xt.faChevronUp:jt.faChevronDown})})]})]})}),t.jsx(Mt,{className:"py-4 px-4 bg-muted",children:a})]})};var $={},ie;function At(){return ie||(ie=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="fas",s="paper-plane",n=512,r=512,i=[61913],l="f1d8",o="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faPaperPlane=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}($)),$}var Et=At(),K={},oe;function Dt(){return oe||(oe=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="fas",s="hourglass-half",n=384,r=512,i=["hourglass-2"],l="f252",o="M32 0C14.3 0 0 14.3 0 32S14.3 64 32 64l0 11c0 42.4 16.9 83.1 46.9 113.1L146.7 256 78.9 323.9C48.9 353.9 32 394.6 32 437l0 11c-17.7 0-32 14.3-32 32s14.3 32 32 32l32 0 256 0 32 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l0-11c0-42.4-16.9-83.1-46.9-113.1L237.3 256l67.9-67.9c30-30 46.9-70.7 46.9-113.1l0-11c17.7 0 32-14.3 32-32s-14.3-32-32-32L320 0 64 0 32 0zM96 75l0-11 192 0 0 11c0 19-5.6 37.4-16 53L112 128c-10.3-15.6-16-34-16-53zm16 309c3.5-5.3 7.6-10.3 12.1-14.9L192 301.3l67.9 67.9c4.6 4.6 8.6 9.6 12.1 14.9L112 384z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faHourglassHalf=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}(K)),K}var Tt=Dt();const X=P.forwardRef(({className:e,sendButtonArrangement:a="append",onSend:s,isProcessing:n=!1,isDisabled:r,testId:i="chat-prompt-input",initialValue:l="",...o},u)=>{const{t:f}=N(),c=h.useRef(null),[d,p]=h.useState(l);h.useImperativeHandle(u,()=>c.current),h.useEffect(()=>{const g=c.current;if(g){g.style.height="auto";const b=g.scrollHeight;g.style.height=`${b}px`,g.style.overflow=b>300?"auto":"hidden"}},[d]);const[j,C]=P.useState(!1),[y,x]=P.useState(!1),L=()=>{d.trim()&&(s==null||s(d),p(""))},v=n||r||!d.trim(),M=f(v&&!n?"Ask a question":v&&n?"Processing... Waiting for response.":"Send message");return t.jsxs("div",{id:"prompt-input-container","aria-disabled":r,"data-testid":i,className:F("flex gap-2 justify-start items-center px-3 py-3 w-full min-w-3xs mr-4","border-input rounded-md border shadow-xs","bg-transparent placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground","text-base transition-[color,box-shadow]","ring-ring/10 outline-ring/50",j&&"ring-4 outline-1 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",a==="prepend"?"flex-row-reverse":"flex-row",e),children:[t.jsx("textarea",{id:"prompt-input-textarea",className:F("flex leading-5 box-content max-h-[300px] justify-center w-full resize-none overflow-hidden bg-transparent placeholder:text-muted-foreground focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",e),rows:1,onCompositionStart:()=>x(!0),onCompositionEnd:()=>x(!1),onKeyDown:g=>{!y&&!n&&!r&&g.key==="Enter"&&!(g.shiftKey||g.altKey)&&(g.preventDefault(),L())},onFocus:()=>C(!0),onBlur:()=>C(!1),onChange:g=>p(g.target.value),value:d,ref:c,disabled:r,...o}),t.jsx(A,{variant:"ghost",testId:"send-message-button",disabled:v,onClick:L,title:M,children:t.jsx(E,{icon:n?Tt.faHourglassHalf:Et.faPaperPlane,size:"lg"})})]})});X.displayName="PromptInput";const It="data:image/svg+xml,%3csvg%20width='200'%20height='200'%20viewBox='0%200%20200%20200'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%20136V128L100%2080L184%20128V136L100%20184L16%20136Z'%20fill='%231D2226'/%3e%3cpath%20d='M16%20128V136L100%20184M16%20128L100%20176M16%20128L100%2080L184%20128M184%20128V136L100%20184M184%20128L100%20176M100%20176V184'%20stroke='%233E454D'%20stroke-width='0.5'/%3e%3cpath%20d='M69.7677%2089.5558C65.1232%2092.2373%2061.358%2098.7587%2061.358%20104.122V139.898C61.358%20145.261%2065.1232%20147.434%2069.7677%20144.753L109.564%20121.776C113.697%20124.463%20122.887%20124.241%20130.551%20121.287C132.038%20120.714%20133.499%20120.047%20134.915%20119.306C129.545%20120.349%20125.042%20117.697%20124.384%20113.22L133.504%20107.955C138.148%20105.273%20141.914%2098.7519%20141.914%2093.3889V57.6129C141.914%2052.2499%20138.148%2050.0762%20133.504%2052.7576L69.7677%2089.5558Z'%20fill='%233E454D'%20stroke='%23111519'%20stroke-width='0.5'/%3e%3cpath%20d='M70.457%20101.309L70.457%2098.6077L132.034%2063.3482L132.034%2069.1356L70.457%20105.055L70.457%20101.309Z'%20fill='%232A3036'/%3e%3cpath%20d='M70.457%20111.572L70.457%20108.871L132.034%2073.611L132.034%2079.3984L70.457%20115.318L70.457%20111.572Z'%20fill='%232A3036'/%3e%3cpath%20d='M70.457%20121.835L70.457%20119.133L132.034%2083.8737L132.034%2089.6612L70.457%20125.581L70.457%20121.835Z'%20fill='%232A3036'/%3e%3cpath%20d='M70.457%20132.097L70.457%20129.396L118.564%20101.192L118.564%20106.979L70.457%20135.843L70.457%20132.097Z'%20fill='%232A3036'/%3e%3cpath%20d='M61.5408%20141.815C61.421%20141.232%2061.358%20140.591%2061.358%20139.898V104.122C61.358%2098.7587%2065.1232%2092.2374%2069.7677%2089.5558L133.504%2052.7577C135.147%2051.8088%20136.681%2051.4679%20137.976%2051.6612C134.9%2049.4301%20130.778%2049.6702%20128.363%2051.0645L65.4096%2087.3768C60.7651%2090.0583%2057%2096.5797%2057%20101.943V137.719C57%20140.4%2059.179%20144.217%2063.8893%20145.718C62.6782%20145.019%2061.8347%20143.683%2061.5408%20141.815Z'%20fill='%232A3036'%20stroke='%23111519'%20stroke-width='0.5'/%3e%3cpath%20d='M157%2057.0565L148.736%2058.2967L147.966%2056.3392L145.677%2050.5195L142.619%2061.828L142.139%2062.3104L134.355%2070.1306L140.483%2069.2109L142.619%2068.8904L145.677%2076.6677L148.662%2065.6322L148.736%2065.3592L157%2057.0565Z'%20fill='%2342C0FC'%20stroke='%231D2226'%20stroke-width='0.5'/%3e%3c/svg%3e",Rt=({chatId:e,allowedDataSources:a,testId:s})=>{const{t:n}=N(),{enableChartGeneration:r,enableBusinessInsights:i,dataSource:l}=V(),{data:o}=k(),{sendMessage:u}=H(e),f=!(a!=null&&a[0]),c=e?o==null?void 0:o.find(p=>p.id===e):void 0,d=h.useMemo(()=>{const p=(c==null?void 0:c.data_source)||l;return a!=null&&a.includes(p)?p:(a==null?void 0:a[0])||w.FILE},[c==null?void 0:c.data_source,l,a]);return t.jsx("div",{className:"flex-1 flex flex-col p-4","data-testid":s,children:t.jsx("div",{className:"flex flex-col flex-1 items-center justify-center",children:t.jsxs("div",{className:"w-[400px] flex flex-col flex-1 items-center justify-center",children:[t.jsx("img",{src:It,alt:""}),t.jsx("h4",{className:"mb-2 mt-4",children:t.jsx("strong",{className:" text-center font-semibold",children:n("Type a question about your dataset")})}),t.jsx("p",{className:"text-center mb-10",children:n("Ask specific questions about your datasets to get insights, generate visualizations, and discover patterns. Include column names and the kind of analysis you're looking for to get more accurate results.")}),t.jsx(X,{sendButtonArrangement:"append",onSend:p=>u(p,{enableChartGeneration:r,enableBusinessInsights:i,dataSource:d}),isDisabled:f,testId:"initial-prompt-input",placeholder:n("Ask another question about your datasets.")})]})})})},Ft=()=>t.jsxs("div",{className:"h-6 px-3 py-[7px] bg-[#2a3036] rounded-[100px] justify-center items-center gap-1 flex",children:[t.jsx("div",{className:"items-end gap-2.5 flex animate-bounce",children:t.jsx("div",{className:"w-2 h-2 bg-[#8f97a1] rounded-full"})}),t.jsx("div",{className:"items-end gap-2.5 flex animate-bounce [animation-delay:-.3s]",children:t.jsx("div",{className:"w-2 h-2 bg-[#8f97a1] rounded-full"})}),t.jsx("div",{className:"items-end gap-2.5 flex animate-bounce [animation-delay:-.5s]",children:t.jsx("div",{className:"w-2 h-2 bg-[#8f97a1] rounded-full"})})]}),oa=P.memo(P.forwardRef(({children:e,testId:a,...s},n)=>t.jsx("div",{className:"p-3 bg-card rounded flex-col justify-start items-start gap-3 flex mb-8 mr-2","data-testid":a,ref:n,...s,children:e}))),la=e=>{if(!e)return null;try{return{paper_bgcolor:"rgba(255,255,255, 0)",...JSON.parse(e)}}catch(a){return console.error("Failed to parse plot data:",a),null}},St=e=>{if(!e)return"";try{return new Date(e).toLocaleString(Be.language,{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(a){return console.error("Error formatting date:",a),""}},Gt=({messageId:e,chatId:a})=>{const{t:s}=N(),[n,r]=h.useState(!1),{isDeleting:i,isExporting:l,deleteMessagePair:o,exportMessage:u,getMessage:f,getResponseMessage:c}=H(a),d=f(e);if(!d)return null;const p=d.role==="user",j=p?mt:pt,C=s(p?"You":"DataRobot"),y=St(d.created_at),x=c(e),L=!!(x!=null&&x.in_progress),v=!!(x!=null&&x.error),M=l||L||v,g=s(v?"Cannot export chat with errors":l?"Exporting...":L?"Wait for agent to finish responding":"Export chat");return t.jsxs(t.Fragment,{children:[t.jsx(be,{open:n,onOpenChange:r,title:s("Delete message"),description:s("Are you sure you want to delete this message?"),onConfirm:()=>o(e),confirmText:s("Delete"),cancelText:s("Cancel"),variant:"destructive",isLoading:i}),t.jsxs("div",{className:"self-stretch justify-between items-center gap-1 inline-flex",children:[t.jsxs("div",{className:"grow shrink basis-0 h-6 justify-start items-center gap-2 flex",children:[j(),t.jsx("div",{className:"text-sm font-semibold leading-tight",children:C}),t.jsx("div",{className:"text-xs font-normal leading-[17px]",children:y})]}),p&&t.jsxs("div",{className:"flex items-center",children:[t.jsx(A,{variant:"ghost",size:"sm",onClick:()=>u(e),title:g,disabled:M,children:t.jsx(E,{icon:Ce.faFileArrowDown})}),t.jsx(A,{variant:"ghost",size:"sm",onClick:()=>r(!0),title:s("Delete message and response"),children:t.jsx(E,{icon:je.faTrash})})]})]})]})},Vt=h.lazy(()=>me(()=>import("./react-plotly-CzsfXI6m.js").then(e=>e.r),__vite__mapDeps([0,1,2]),import.meta.url)),kt=()=>{const{t:e}=N();return t.jsx("div",{className:"flex items-center justify-center p-4 h-[200px]",children:t.jsx("div",{children:e("Loading visualization...")})})},ca=({plotData:e,className:a="",width:s="100%",height:n="500px"})=>{var r,i;return!e||!e.data||!e.layout?null:t.jsx(_t,{header:(i=(r=e.layout)==null?void 0:r.title)==null?void 0:i.text,children:t.jsx(h.Suspense,{fallback:t.jsx(kt,{}),children:t.jsx(Vt,{data:e.data,layout:e.layout,className:a,style:{position:"relative",width:s,height:n},config:{responsive:!0}})})})},Ht=({message:e,chatId:a,testId:s})=>{const n=h.useRef(null);return h.useEffect(()=>{var r;(r=n.current)==null||r.scrollIntoView({behavior:"smooth"})},[e.content]),t.jsxs("div",{className:"p-3 bg-card rounded flex-col justify-start items-start gap-3 flex mb-2.5 mr-2",ref:n,"data-testid":s,children:[t.jsx(Gt,{messageId:e.id,chatId:a}),t.jsx("div",{className:"self-stretch text-sm font-normal leading-tight whitespace-pre-line",children:e.content}),e.in_progress&&t.jsx("div",{className:"flex w-full justify-start",children:t.jsx(Ft,{})})]})},Ot=({chatId:e,allowedDataSources:a,testId:s})=>{const{t:n}=N(),{enableChartGeneration:r,enableBusinessInsights:i,dataSource:l}=V(),{data:o}=k(),{hasInProgressMessages:u,sendMessage:f}=H(e),c=!(a!=null&&a[0]),d=e?o==null?void 0:o.find(j=>j.id===e):void 0,p=h.useMemo(()=>{const j=(d==null?void 0:d.data_source)||l;return a!=null&&a.includes(j)?j:(a==null?void 0:a[0])||w.FILE},[d==null?void 0:d.data_source,l,a]);return t.jsx(X,{sendButtonArrangement:"append",onSend:j=>f(j,{enableChartGeneration:r,enableBusinessInsights:i,dataSource:p}),isProcessing:u,placeholder:n(c?"Please upload and process data using the sidebar before starting the chat":"Ask another question about your datasets."),isDisabled:c,testId:s})};var W={},le;function zt(){return le||(le=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var a="fas",s="pencil",n=512,r=512,i=[9999,61504,"pencil-alt"],l="f303",o="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1 0 32c0 8.8 7.2 16 16 16l32 0zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z";e.definition={prefix:a,iconName:s,icon:[n,r,i,l,o]},e.faPencil=e.definition,e.prefix=a,e.iconName=s,e.width=n,e.height=r,e.ligatures=i,e.unicode=l,e.svgPathData=o,e.aliases=i}(W)),W}var Bt=zt();const qt=({chatId:e,currentName:a})=>{const[s,n]=h.useState(a),[r,i]=h.useState(!1),{mutate:l,isPending:o}=qe(),{t:u}=N();return t.jsxs(Ue,{defaultOpen:!1,open:r,onOpenChange:f=>{f&&n(a),i(f)},children:[t.jsx(Ze,{asChild:!0,children:t.jsx(A,{variant:"link",className:"ml-2",children:t.jsx(E,{icon:Bt.faPencil})})}),t.jsxs($e,{className:"sm:max-w-[500px]",children:[t.jsxs(Ke,{children:[t.jsx(We,{children:u("Rename chat")}),t.jsx(Je,{children:u("Enter a new name for this chat.")})]}),t.jsx("div",{className:"grid gap-4 py-4",children:t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Ye,{htmlFor:"rename",className:"text-right",children:u("Chat name")}),t.jsx(Qe,{id:"rename",value:s,onChange:f=>n(f.target.value),className:"col-span-3",placeholder:u("Enter a new name for this chat"),disabled:o,onKeyDown:f=>{f.key==="Enter"&&s.trim()&&s!==a&&l({chatId:e,name:s.trim()},{onSuccess:()=>{i(!1)}})}})]})}),t.jsxs(Xe,{children:[t.jsx(A,{variant:"ghost",onClick:()=>{n(a),i(!1)},children:u("Cancel")}),t.jsx(A,{onClick:()=>{s.trim()&&s!==a&&l({chatId:e,name:s.trim()},{onSuccess:()=>{i(!1)}})},disabled:o||!s.trim()||s===a,children:u(o?"Renaming...":"Rename")})]})]})]})};var Ne="Toggle",Me=h.forwardRef((e,a)=>{const{pressed:s,defaultPressed:n,onPressedChange:r,...i}=e,[l,o]=G({prop:s,onChange:r,defaultProp:n??!1,caller:Ne});return t.jsx(R.button,{type:"button","aria-pressed":l,"data-state":l?"on":"off","data-disabled":e.disabled?"":void 0,...i,ref:a,onClick:pe(e.onClick,()=>{e.disabled||o(!l)})})});Me.displayName=Ne;var D="ToggleGroup",[_e,da]=he(D,[ve]),Ae=ve(),ee=P.forwardRef((e,a)=>{const{type:s,...n}=e;if(s==="single"){const r=n;return t.jsx(Ut,{...r,ref:a})}if(s==="multiple"){const r=n;return t.jsx(Zt,{...r,ref:a})}throw new Error(`Missing prop \`type\` expected on \`${D}\``)});ee.displayName=D;var[Ee,De]=_e(D),Ut=P.forwardRef((e,a)=>{const{value:s,defaultValue:n,onValueChange:r=()=>{},...i}=e,[l,o]=G({prop:s,defaultProp:n??"",onChange:r,caller:D});return t.jsx(Ee,{scope:e.__scopeToggleGroup,type:"single",value:P.useMemo(()=>l?[l]:[],[l]),onItemActivate:o,onItemDeactivate:P.useCallback(()=>o(""),[o]),children:t.jsx(Te,{...i,ref:a})})}),Zt=P.forwardRef((e,a)=>{const{value:s,defaultValue:n,onValueChange:r=()=>{},...i}=e,[l,o]=G({prop:s,defaultProp:n??[],onChange:r,caller:D}),u=P.useCallback(c=>o((d=[])=>[...d,c]),[o]),f=P.useCallback(c=>o((d=[])=>d.filter(p=>p!==c)),[o]);return t.jsx(Ee,{scope:e.__scopeToggleGroup,type:"multiple",value:l,onItemActivate:u,onItemDeactivate:f,children:t.jsx(Te,{...i,ref:a})})});ee.displayName=D;var[$t,Kt]=_e(D),Te=P.forwardRef((e,a)=>{const{__scopeToggleGroup:s,disabled:n=!1,rovingFocus:r=!0,orientation:i,dir:l,loop:o=!0,...u}=e,f=Ae(s),c=tt(l),d={role:"group",dir:c,...u};return t.jsx($t,{scope:s,rovingFocus:r,disabled:n,children:r?t.jsx(at,{asChild:!0,...f,orientation:i,dir:c,loop:o,children:t.jsx(R.div,{...d,ref:a})}):t.jsx(R.div,{...d,ref:a})})}),S="ToggleGroupItem",Ie=P.forwardRef((e,a)=>{const s=De(S,e.__scopeToggleGroup),n=Kt(S,e.__scopeToggleGroup),r=Ae(e.__scopeToggleGroup),i=s.value.includes(e.value),l=n.disabled||e.disabled,o={...e,pressed:i,disabled:l},u=P.useRef(null);return n.rovingFocus?t.jsx(et,{asChild:!0,...r,focusable:!l,active:i,ref:u,children:t.jsx(ce,{...o,ref:a})}):t.jsx(ce,{...o,ref:a})});Ie.displayName=S;var ce=P.forwardRef((e,a)=>{const{__scopeToggleGroup:s,value:n,...r}=e,i=De(S,s),l={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},o=i.type==="single"?l:void 0;return t.jsx(Me,{...o,...r,ref:a,onPressedChange:u=>{u?i.onItemActivate(n):i.onItemDeactivate(n)}})}),Wt=ee,Jt=Ie;const Yt=st("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),Re=h.createContext({size:"default",variant:"default"});function Qt({className:e,variant:a,size:s,children:n,...r}){return t.jsx(Wt,{"data-slot":"toggle-group","data-variant":a,"data-size":s,className:F("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",e),...r,children:t.jsx(Re.Provider,{value:{variant:a,size:s},children:n})})}function de({className:e,children:a,variant:s,size:n,...r}){const i=h.useContext(Re);return t.jsx(Jt,{"data-slot":"toggle-group-item","data-variant":i.variant||s,"data-size":i.size||n,className:F(Yt({variant:i.variant||s,size:i.size||n}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l cursor-pointer",e),...r,children:a})}const Xt=({multipleMetadata:e})=>{var c;const{chatId:a}=xe(),{dataSource:s,setDataSource:n}=V(),{data:r}=k(),{mutate:i}=nt(),l=d=>{d&&(a&&i({chatId:a,dataSource:d}),n(d))},o=a&&((c=r==null?void 0:r.find(d=>d.id===a))==null?void 0:c.data_source)||s,u=h.useMemo(()=>e==null?void 0:e.reduce((d,{name:p,metadata:j})=>{const{data_source:C}=j;return o===w.FILE&&(C===w.FILE||C===w.CATALOG)&&d.push(p),o===w.DATABASE&&C===w.DATABASE&&d.push(p),d},[]),[e,o]),f=()=>t.jsxs("div",{className:"absolute min-w-[270px] max-w-[600px] left-1/2 -translate-x-1/2 top-full mb-2 hidden bg-secondary text-secondary-foreground group-hover:block text-xs rounded px-2 py-1 shadow z-10",children:["Selected data sources:",u&&(u==null?void 0:u.length)>0?t.jsx("ul",{className:"list-disc pl-5",children:u.map(d=>t.jsx("li",{className:"text-sm",children:d},d))}):t.jsx("div",{className:"text-sm",children:"No data sources selected."})]});return t.jsxs(Qt,{type:"single",value:o,onValueChange:l,className:"bg-muted rounded-md p-1 shadow-sm group relative",children:[f(),t.jsx(de,{value:w.DATABASE,className:"text-sm",children:t.jsx("div",{className:"m-2",children:"Database"})}),t.jsx(de,{value:w.FILE,className:"text-sm",children:t.jsx("div",{className:"m-2",children:"Registry / File"})})]})},ea=h.lazy(()=>me(()=>import("./ResponseMessage-DhbwFvMo.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url).then(e=>({default:e.ResponseMessage}))),ta=()=>{const{t:e}=N();return t.jsx("div",{className:"p-4 text-sm",children:e("Loading component...")})},aa=()=>{const{t:e}=N(),{chatId:a}=xe(),s=fe(),[n,r]=h.useState(!1),{messages:i,isLoading:l,hasInProgressMessages:o,hasFailedMessages:u}=H(a),{data:f}=k(),c=f?f.find(m=>m.id===a):void 0,{mutate:d,isPending:p}=rt({onSuccess:()=>{const m=(f==null?void 0:f.filter(T=>T.id!==(c==null?void 0:c.id)))||[];if(r(!1),m.length>0){const T=[...m].sort((I,te)=>{const Fe=I.created_at?new Date(I.created_at).getTime():0;return(te.created_at?new Date(te.created_at).getTime():0)-Fe});s(`/chats/${T[0].id}`)}else s(ge.CHATS)}}),{exportChat:j,isLoading:C}=ue(),{data:y}=it(),{data:x}=lt((y==null?void 0:y.map(m=>m.name))||[]),{hasMixedSources:L,allowedDataSources:v}=h.useMemo(()=>{if(!x)return{allowedDataSources:[],hasMixedSources:!1};const m=new Set;return x.forEach(({metadata:T})=>{const{data_source:I}=T;I===w.FILE||I===w.CATALOG?m.add(w.FILE):I===w.DATABASE&&m.add(w.DATABASE)}),{allowedDataSources:Array.from(m),hasMixedSources:m.has(w.FILE)&&m.has(w.DATABASE)}},[x]),M=e(u?"Cannot export chat with errors":C?"Exporting...":o?"Wait for agent to finish responding":"Export chat"),g=C||o||u,b=()=>{c!=null&&c.id&&d({chatId:c.id})},_=()=>c?t.jsxs(t.Fragment,{children:[t.jsx(be,{open:n,isLoading:p,onOpenChange:r,title:e("Delete chat"),confirmText:e("Delete"),cancelText:e("Cancel"),description:e("Are you sure you want to delete this chat?"),onConfirm:b,variant:"destructive"}),t.jsxs("h2",{className:"text-xl flex-1",children:[t.jsx("strong",{children:c.name||e("New Chat")}),t.jsx(qt,{chatId:c.id,currentName:c.name})]}),t.jsx("div",{children:L&&t.jsx(Xt,{multipleMetadata:x})}),t.jsxs(A,{variant:"ghost",onClick:()=>j({chatId:c.id}),disabled:g,title:M,testId:"export-chat-button",children:[t.jsx(E,{icon:Ce.faFileArrowDown}),t.jsx("span",{className:"ml-2",children:e(C?"Exporting...":"Export chat")})]}),t.jsxs(A,{variant:"ghost",onClick:()=>r(!0),testId:"delete-all-chats-button",children:[t.jsx(E,{icon:je.faTrash}),t.jsx("span",{className:"ml-2",children:e("Delete chat")})]})]}):null;return t.jsxs("div",{className:"p-6 h-full flex flex-col",children:[t.jsx("div",{className:"flex justify-between items-center gap-2 h-9",children:_()}),t.jsx(ot,{className:"my-4 border-t"}),l&&!(i!=null&&i.length)?t.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:t.jsx(ct,{})}):(i==null?void 0:i.length)===0?t.jsx(Rt,{allowedDataSources:v,chatId:c==null?void 0:c.id,testId:"initial-prompt"}):t.jsxs(t.Fragment,{children:[t.jsx(dt,{className:"flex flex-1 flex-col overflow-y-hidden pr-2 pb-4",children:i==null?void 0:i.map(m=>c!=null&&c.id?t.jsxs("div",{className:"flex flex-col w-full",children:[m.role==="user"&&t.jsx(Ht,{message:m,chatId:c.id,testId:`user-message-${m.id}`}),m.role==="assistant"&&t.jsx(h.Suspense,{fallback:t.jsx(ta,{}),children:t.jsx(ea,{message:m,chatId:c.id,testId:`response-message-${m.id}`})})]},m.id):null)}),t.jsx("div",{className:"flex w-full justify-center",children:t.jsx(Ot,{allowedDataSources:v,chatId:c==null?void 0:c.id,testId:"user-prompt"})})]})]})},ua=Object.freeze(Object.defineProperty({__proto__:null,Chats:aa},Symbol.toStringTag,{value:"Module"}));export{_t as C,Ft as L,oa as M,ca as P,Et as a,Gt as b,ua as c,Tt as f,la as p,H as u};
