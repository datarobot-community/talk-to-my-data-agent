const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./react-plotly-hUmd_Kgi.js","./index-Dr41AYLo.js","./index-U5LMoOKn.css","./ResponseMessage-Bi-Z-iLQ.js","./tabs-DXqZvLd5.js","./loading-CEFhaZVm.js"])))=>i.map(i=>d[i]);
import{j as t,F as w,h as re,p as ie,r as d,q as I,s as oe,t as Te,P as T,v as le,w as De,x as Ee,y as Re,z as F,R as j,e as _,u as N,A as k,C as ce,E as b,B as A,_ as de,G as Ie,H as Fe,J as ke,K as Se,L as Ve,M as Ge,N as Oe,O as ze,Q as He,T as qe,I as Be,U as Ze,V as ue,W as Ue,X as $e,Y as Ke,Z as Je,k as fe,$ as Ye,a0 as Qe,a1 as We,m as Xe,S as et,a2 as tt}from"./index-Dr41AYLo.js";import{C as ge,f as he,b as at,L as nt,S as st}from"./loading-CEFhaZVm.js";var V={},Y;function rt(){return Y||(Y=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",a="file-arrow-down",i=384,r=512,s=["file-download"],l="f56d",o="M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM216 232l0 102.1 31-31c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-72 72c-9.4 9.4-24.6 9.4-33.9 0l-72-72c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l31 31L168 232c0-13.3 10.7-24 24-24s24 10.7 24 24z";e.definition={prefix:n,iconName:a,icon:[i,r,s,l,o]},e.faFileArrowDown=e.definition,e.prefix=n,e.iconName=a,e.width=i,e.height=r,e.ligatures=s,e.unicode=l,e.svgPathData=o,e.aliases=s}(V)),V}var it=rt(),G={},Q;function ot(){return Q||(Q=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="far",a="comment",i=512,r=512,s=[128489,61669],l="f075",o="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9l.3-.5z";e.definition={prefix:n,iconName:a,icon:[i,r,s,l,o]},e.faComment=e.definition,e.prefix=n,e.iconName=a,e.width=i,e.height=r,e.ligatures=s,e.unicode=l,e.svgPathData=o,e.aliases=s}(G)),G}var lt=ot();const ct="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20%3e%3crect%20x='0.682129'%20width='24'%20height='24'%20rx='12'%20fill='%2373FF95'%20/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.93506%205.49414H12.6824V6.93975H5.93506V5.49414ZM16.052%206.93994H12.6783V8.38555H16.052V6.93994ZM5.93506%208.38573H12.6824V9.83134H5.93506V8.38573ZM19.4293%209.83294H16.0556V11.2773H5.93506V12.7229H16.056V11.2786H19.4293V9.83294ZM19.4293%2012.7231H16.0556V14.1687H19.4293V12.7231ZM5.93506%2014.1689H12.6824V15.6145H5.93506V14.1689ZM16.052%2015.6147H12.6783V17.0603H16.052V15.6147ZM12.6824%2017.0605H5.93506V18.5061H12.6824V17.0605Z'%20fill='%23181D21'%20/%3e%3c/svg%3e",Jt=()=>{const e=re();return t.jsx("div",{className:"text-center text-sm font-normal leading-tight text-primary-foreground",children:t.jsx("img",{src:ct,alt:"",className:"cursor-pointer",onClick:()=>e(ie.DATA)})})},dt=()=>t.jsx("div",{className:"w-6 h-6 p-2.5 bg-[#7c97f8] rounded-[100px] flex-col justify-center items-center gap-2.5 inline-flex overflow-hidden",children:t.jsx("div",{className:"text-center text-sm font-normal leading-tight text-primary-foreground",children:t.jsx(w,{icon:lt.faComment})})});var O={},W;function ut(){return W||(W=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",a="chevron-up",i=512,r=512,s=[],l="f077",o="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z";e.definition={prefix:n,iconName:a,icon:[i,r,s,l,o]},e.faChevronUp=e.definition,e.prefix=n,e.iconName=a,e.width=i,e.height=r,e.ligatures=s,e.unicode=l,e.svgPathData=o,e.aliases=s}(O)),O}var ft=ut(),z={},X;function gt(){return X||(X=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",a="chevron-down",i=512,r=512,s=[],l="f078",o="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z";e.definition={prefix:n,iconName:a,icon:[i,r,s,l,o]},e.faChevronDown=e.definition,e.prefix=n,e.iconName=a,e.width=i,e.height=r,e.ligatures=s,e.unicode=l,e.svgPathData=o,e.aliases=s}(z)),z}var ht=gt(),S="Collapsible",[pt,Yt]=oe(S),[mt,B]=pt(S),pe=d.forwardRef((e,n)=>{const{__scopeCollapsible:a,open:i,defaultOpen:r,disabled:s,onOpenChange:l,...o}=e,[c,f]=I({prop:i,defaultProp:r??!1,onChange:l,caller:S});return t.jsx(mt,{scope:a,disabled:s,contentId:Te(),open:c,onOpenToggle:d.useCallback(()=>f(h=>!h),[f]),children:t.jsx(T.div,{"data-state":U(c),"data-disabled":s?"":void 0,...o,ref:n})})});pe.displayName=S;var me="CollapsibleTrigger",ve=d.forwardRef((e,n)=>{const{__scopeCollapsible:a,...i}=e,r=B(me,a);return t.jsx(T.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":U(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...i,ref:n,onClick:le(e.onClick,r.onOpenToggle)})});ve.displayName=me;var Z="CollapsibleContent",xe=d.forwardRef((e,n)=>{const{forceMount:a,...i}=e,r=B(Z,e.__scopeCollapsible);return t.jsx(De,{present:a||r.open,children:({present:s})=>t.jsx(vt,{...i,ref:n,present:s})})});xe.displayName=Z;var vt=d.forwardRef((e,n)=>{const{__scopeCollapsible:a,present:i,children:r,...s}=e,l=B(Z,a),[o,c]=d.useState(i),f=d.useRef(null),h=Ee(n,f),u=d.useRef(0),p=u.current,x=d.useRef(0),g=x.current,m=l.open||o,D=d.useRef(m),M=d.useRef(void 0);return d.useEffect(()=>{const C=requestAnimationFrame(()=>D.current=!1);return()=>cancelAnimationFrame(C)},[]),Re(()=>{const C=f.current;if(C){M.current=M.current||{transitionDuration:C.style.transitionDuration,animationName:C.style.animationName},C.style.transitionDuration="0s",C.style.animationName="none";const v=C.getBoundingClientRect();u.current=v.height,x.current=v.width,D.current||(C.style.transitionDuration=M.current.transitionDuration,C.style.animationName=M.current.animationName),c(i)}},[l.open,i]),t.jsx(T.div,{"data-state":U(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!m,...s,ref:h,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:m&&r})});function U(e){return e?"open":"closed"}var xt=pe;function bt({...e}){return t.jsx(xt,{"data-slot":"collapsible",...e})}function jt({...e}){return t.jsx(ve,{"data-slot":"collapsible-trigger",...e})}function Ct({...e}){return t.jsx(xe,{"data-slot":"collapsible-content",...e})}const yt=({header:e,children:n})=>{const{collapsiblePanelDefaultOpen:a}=F(),[i,r]=j.useState(a),s=d.useRef(null);return d.useEffect(()=>{var l;(l=s.current)==null||l.scrollIntoView(!1)}),t.jsxs(bt,{open:i,onOpenChange:r,className:"rounded border border-border",children:[t.jsx(jt,{asChild:!0,className:"bg-muted",children:t.jsxs("div",{className:"h-[52px] flex justify-between items-center px-4 cursor-pointer",children:[t.jsx("div",{children:e}),t.jsx(w,{icon:i?ft.faChevronUp:ht.faChevronDown})]})}),t.jsx(Ct,{ref:s,className:"py-4 px-4 bg-muted",children:n})]})},$=j.forwardRef(({className:e,icon:n,onKeyDown:a,iconProps:{behavior:i,...r},value:s,...l},o)=>{const c=n,f=d.useRef(null);d.useImperativeHandle(o,()=>f.current),d.useEffect(()=>{const g=f.current;if(g){g.style.height="auto";const m=g.scrollHeight;g.style.height=`${m}px`,g.style.overflow=m>300?"auto":"hidden"}},[s,o]);const[h,u]=j.useState(!1),[p,x]=j.useState(!1);return t.jsxs("div",{className:_("flex border-input file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground aria-invalid:outline-destructive/60 aria-invalid:ring-destructive/20 dark:aria-invalid:outline-destructive dark:aria-invalid:ring-destructive/50 ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 aria-invalid:border-destructive/60 dark:aria-invalid:border-destructive w-full rounded-md border bg-transparent px-3 py-3 text-base shadow-xs transition-[color,box-shadow] file:inline-flex file:border-0 file:bg-transparent file:text-sm file:font-medium min-w-[600px] justify-start items-center",h&&"ring-4 outline-1 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",e),children:[c&&i==="prepend"&&r.icon&&t.jsx("div",{className:_("w-4 h-4 mr-3 text-muted-foreground"),children:t.jsx(c,{...r})}),t.jsx("textarea",{className:_("flex leading-5 box-content max-h-[300px] justify-center w-full resize-none overflow-hidden bg-transparent placeholder:text-muted-foreground file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",e),rows:1,onCompositionStart:()=>x(!0),onCompositionEnd:()=>x(!1),onKeyDown:g=>{a&&!p&&a(g)},onFocus:()=>u(!0),onBlur:()=>u(!1),ref:f,...l}),c&&i==="append"&&r.icon&&t.jsx("div",{className:_("w-4 ml-3 text-muted-foreground h-4 flex-col justify-center items-center inline-flex cursor-pointer"),children:t.jsx(c,{...r})})]})});$.displayName="PromptInput";var H={},ee;function Pt(){return ee||(ee=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",a="paper-plane",i=512,r=512,s=[61913],l="f1d8",o="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z";e.definition={prefix:n,iconName:a,icon:[i,r,s,l,o]},e.faPaperPlane=e.definition,e.prefix=n,e.iconName=a,e.width=i,e.height=r,e.ligatures=s,e.unicode=l,e.svgPathData=o,e.aliases=s}(H)),H}var be=Pt();const wt="data:image/svg+xml,%3csvg%20width='200'%20height='200'%20viewBox='0%200%20200%20200'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%20136V128L100%2080L184%20128V136L100%20184L16%20136Z'%20fill='%231D2226'/%3e%3cpath%20d='M16%20128V136L100%20184M16%20128L100%20176M16%20128L100%2080L184%20128M184%20128V136L100%20184M184%20128L100%20176M100%20176V184'%20stroke='%233E454D'%20stroke-width='0.5'/%3e%3cpath%20d='M69.7677%2089.5558C65.1232%2092.2373%2061.358%2098.7587%2061.358%20104.122V139.898C61.358%20145.261%2065.1232%20147.434%2069.7677%20144.753L109.564%20121.776C113.697%20124.463%20122.887%20124.241%20130.551%20121.287C132.038%20120.714%20133.499%20120.047%20134.915%20119.306C129.545%20120.349%20125.042%20117.697%20124.384%20113.22L133.504%20107.955C138.148%20105.273%20141.914%2098.7519%20141.914%2093.3889V57.6129C141.914%2052.2499%20138.148%2050.0762%20133.504%2052.7576L69.7677%2089.5558Z'%20fill='%233E454D'%20stroke='%23111519'%20stroke-width='0.5'/%3e%3cpath%20d='M70.457%20101.309L70.457%2098.6077L132.034%2063.3482L132.034%2069.1356L70.457%20105.055L70.457%20101.309Z'%20fill='%232A3036'/%3e%3cpath%20d='M70.457%20111.572L70.457%20108.871L132.034%2073.611L132.034%2079.3984L70.457%20115.318L70.457%20111.572Z'%20fill='%232A3036'/%3e%3cpath%20d='M70.457%20121.835L70.457%20119.133L132.034%2083.8737L132.034%2089.6612L70.457%20125.581L70.457%20121.835Z'%20fill='%232A3036'/%3e%3cpath%20d='M70.457%20132.097L70.457%20129.396L118.564%20101.192L118.564%20106.979L70.457%20135.843L70.457%20132.097Z'%20fill='%232A3036'/%3e%3cpath%20d='M61.5408%20141.815C61.421%20141.232%2061.358%20140.591%2061.358%20139.898V104.122C61.358%2098.7587%2065.1232%2092.2374%2069.7677%2089.5558L133.504%2052.7577C135.147%2051.8088%20136.681%2051.4679%20137.976%2051.6612C134.9%2049.4301%20130.778%2049.6702%20128.363%2051.0645L65.4096%2087.3768C60.7651%2090.0583%2057%2096.5797%2057%20101.943V137.719C57%20140.4%2059.179%20144.217%2063.8893%20145.718C62.6782%20145.019%2061.8347%20143.683%2061.5408%20141.815Z'%20fill='%232A3036'%20stroke='%23111519'%20stroke-width='0.5'/%3e%3cpath%20d='M157%2057.0565L148.736%2058.2967L147.966%2056.3392L145.677%2050.5195L142.619%2061.828L142.139%2062.3104L134.355%2070.1306L140.483%2069.2109L142.619%2068.8904L145.677%2076.6677L148.662%2065.6322L148.736%2065.3592L157%2057.0565Z'%20fill='%2342C0FC'%20stroke='%231D2226'%20stroke-width='0.5'/%3e%3c/svg%3e",Nt=({chatId:e,allowedDataSources:n})=>{const{t:a}=N(),{enableChartGeneration:i,enableBusinessInsights:r,dataSource:s}=F(),{data:l}=k(),{mutate:o}=ce(),[c,f]=d.useState(""),h=!(n!=null&&n[0]),u=e?l==null?void 0:l.find(g=>g.id===e):void 0,p=d.useMemo(()=>{const g=(u==null?void 0:u.data_source)||s;return n!=null&&n.includes(g)?g:(n==null?void 0:n[0])||b.FILE},[u==null?void 0:u.data_source,s,n]),x=()=>{c.trim()&&(o({message:c,chatId:e,enableChartGeneration:i,enableBusinessInsights:r,dataSource:p}),f(""))};return t.jsx("div",{className:"flex-1 flex flex-col p-4",children:t.jsx("div",{className:"flex flex-col flex-1 items-center justify-center",children:t.jsxs("div",{className:"w-[400px] flex flex-col flex-1 items-center justify-center",children:[t.jsx("img",{src:wt,alt:""}),t.jsx("h4",{className:"mb-2 mt-4",children:t.jsx("strong",{className:" text-center font-semibold",children:a("Type a question about your dataset")})}),t.jsx("p",{className:"text-center mb-10",children:a("Ask specific questions about your datasets to get insights, generate visualizations, and discover patterns. Include column names and the kind of analysis you're looking for to get more accurate results.")}),t.jsx($,{icon:w,iconProps:{icon:h?null:be.faPaperPlane,behavior:"append","data-testid":"send-message-button",onClick:x},disabled:h,"aria-disabled":h,"data-testid":"initial-prompt-input",onChange:g=>f(g.target.value),onKeyDown:g=>{g.key==="Enter"&&!(g.shiftKey||g.altKey)&&x()},value:c,placeholder:a(h?"Please upload and process data using the sidebar before starting the chat":"Ask another question about your datasets.")})]})})})},Qt=j.memo(({children:e})=>{const n=d.useRef(null);return d.useEffect(()=>{var a;(a=n.current)==null||a.scrollIntoView(!1)}),t.jsx("div",{className:"p-3 bg-card rounded flex-col justify-start items-start gap-3 flex mb-2.5 mr-2",ref:n,children:e})}),Lt=({avatar:e=dt,name:n,date:a,onDelete:i,isLoading:r=!1})=>{const{t:s}=N(),[l,o]=d.useState(!1);return t.jsxs(t.Fragment,{children:[i&&t.jsx(ge,{open:l,onOpenChange:o,title:s("Delete message"),description:s("Are you sure you want to delete this message?"),onConfirm:i,confirmText:s("Delete"),cancelText:s("Cancel"),variant:"destructive",isLoading:r}),t.jsxs("div",{className:"self-stretch justify-between items-center gap-1 inline-flex",children:[t.jsxs("div",{className:"grow shrink basis-0 h-6 justify-start items-center gap-2 flex",children:[e(),t.jsx("div",{className:"text-sm font-semibold leading-tight",children:n}),t.jsx("div",{className:"text-xs font-normal leading-[17px]",children:a})]}),i&&t.jsx(A,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:c=>{c.stopPropagation(),o(!0)},title:s("Delete message"),children:t.jsx(w,{icon:he.faTrash,className:"h-3.5 w-3.5"})})]})]})},Mt=d.lazy(()=>de(()=>import("./react-plotly-hUmd_Kgi.js").then(e=>e.r),__vite__mapDeps([0,1,2]),import.meta.url)),_t=()=>{const{t:e}=N();return t.jsx("div",{className:"flex items-center justify-center p-4 h-[200px]",children:t.jsx("div",{children:e("Loading visualization...")})})},Wt=({plotData:e,className:n="",width:a="100%",height:i="500px"})=>{var r,s;return!e||!e.data||!e.layout?null:t.jsx(yt,{header:(s=(r=e.layout)==null?void 0:r.title)==null?void 0:s.text,children:t.jsx(d.Suspense,{fallback:t.jsx(_t,{}),children:t.jsx(Mt,{data:e.data,layout:e.layout,className:n,style:{position:"relative",width:a,height:i},config:{responsive:!0}})})})},Xt=e=>{if(!e)return null;try{return{paper_bgcolor:"rgba(255,255,255, 0)",...JSON.parse(e)}}catch(n){return console.error("Failed to parse plot data:",n),null}},At=e=>{if(!e)return"";try{return new Date(e).toLocaleString(Ie.language,{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(n){return console.error("Error formatting date:",n),""}},Tt=({id:e,date:n,timestamp:a,message:i,chatId:r,responseId:s})=>{const l=d.useRef(null),{mutate:o,isPending:c}=Fe(),{t:f}=N();d.useEffect(()=>{var p;(p=l.current)==null||p.scrollIntoView(!1)});const h=a?At(a):n||"",u=()=>{e&&o({messageId:e,chatId:r}),s&&o({messageId:s,chatId:r})};return t.jsxs("div",{className:"p-3 bg-card rounded flex-col justify-start items-start gap-3 flex mb-2.5 mr-2",ref:l,children:[t.jsx(Lt,{name:f("You"),date:h,onDelete:u,isLoading:c}),t.jsx("div",{className:"self-stretch text-sm font-normal leading-tight whitespace-pre-line",children:i})]})},Dt=({chatId:e,allowSend:n,allowedDataSources:a})=>{const{t:i}=N(),{mutate:r}=ce(),{enableChartGeneration:s,enableBusinessInsights:l,dataSource:o}=F(),{data:c}=k(),f=!(a!=null&&a[0]),[h,u]=d.useState(""),p=e?c==null?void 0:c.find(m=>m.id===e):void 0,x=d.useMemo(()=>{const m=(p==null?void 0:p.data_source)||o;return a!=null&&a.includes(m)?m:(a==null?void 0:a[0])||b.FILE},[p==null?void 0:p.data_source,o,a]),g=()=>{h.trim()&&(r({message:h,chatId:e,enableChartGeneration:s,enableBusinessInsights:l,dataSource:x}),u(""))};return t.jsx($,{icon:w,iconProps:{icon:f?null:be.faPaperPlane,behavior:"append",onClick:g},placeholder:i(f?"Please upload and process data using the sidebar before starting the chat":"Ask another question about your datasets."),onKeyDown:m=>{n&&m.key==="Enter"&&!(m.shiftKey||m.altKey)&&g()},disabled:f,"aria-disabled":f,onChange:m=>u(m.target.value),value:h})};var q={},te;function Et(){return te||(te=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",a="pencil",i=512,r=512,s=[9999,61504,"pencil-alt"],l="f303",o="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1 0 32c0 8.8 7.2 16 16 16l32 0zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z";e.definition={prefix:n,iconName:a,icon:[i,r,s,l,o]},e.faPencil=e.definition,e.prefix=n,e.iconName=a,e.width=i,e.height=r,e.ligatures=s,e.unicode=l,e.svgPathData=o,e.aliases=s}(q)),q}var Rt=Et();const It=({chatId:e,currentName:n})=>{const[a,i]=d.useState(n),[r,s]=d.useState(!1),{mutate:l,isPending:o}=ke(),{t:c}=N();return t.jsxs(Se,{defaultOpen:!1,open:r,onOpenChange:f=>{f&&i(n),s(f)},children:[t.jsx(Ve,{asChild:!0,children:t.jsx(A,{variant:"link",className:"ml-2",children:t.jsx(w,{icon:Rt.faPencil})})}),t.jsxs(Ge,{className:"sm:max-w-[500px]",children:[t.jsxs(Oe,{children:[t.jsx(ze,{children:c("Rename chat")}),t.jsx(He,{children:c("Enter a new name for this chat.")})]}),t.jsx("div",{className:"grid gap-4 py-4",children:t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(qe,{htmlFor:"rename",className:"text-right",children:c("Chat name")}),t.jsx(Be,{id:"rename",value:a,onChange:f=>i(f.target.value),className:"col-span-3",placeholder:c("Enter a new name for this chat"),disabled:o,onKeyDown:f=>{f.key==="Enter"&&a.trim()&&a!==n&&l({chatId:e,name:a.trim()},{onSuccess:()=>{s(!1)}})}})]})}),t.jsxs(Ze,{children:[t.jsx(A,{variant:"ghost",onClick:()=>{i(n),s(!1)},children:c("Cancel")}),t.jsx(A,{onClick:()=>{a.trim()&&a!==n&&l({chatId:e,name:a.trim()},{onSuccess:()=>{s(!1)}})},disabled:o||!a.trim()||a===n,children:c(o?"Renaming...":"Rename")})]})]})]})};var je="Toggle",Ce=d.forwardRef((e,n)=>{const{pressed:a,defaultPressed:i,onPressedChange:r,...s}=e,[l,o]=I({prop:a,onChange:r,defaultProp:i??!1,caller:je});return t.jsx(T.button,{type:"button","aria-pressed":l,"data-state":l?"on":"off","data-disabled":e.disabled?"":void 0,...s,ref:n,onClick:le(e.onClick,()=>{e.disabled||o(!l)})})});Ce.displayName=je;var L="ToggleGroup",[ye,ea]=oe(L,[ue]),Pe=ue(),K=j.forwardRef((e,n)=>{const{type:a,...i}=e;if(a==="single"){const r=i;return t.jsx(Ft,{...r,ref:n})}if(a==="multiple"){const r=i;return t.jsx(kt,{...r,ref:n})}throw new Error(`Missing prop \`type\` expected on \`${L}\``)});K.displayName=L;var[we,Ne]=ye(L),Ft=j.forwardRef((e,n)=>{const{value:a,defaultValue:i,onValueChange:r=()=>{},...s}=e,[l,o]=I({prop:a,defaultProp:i??"",onChange:r,caller:L});return t.jsx(we,{scope:e.__scopeToggleGroup,type:"single",value:j.useMemo(()=>l?[l]:[],[l]),onItemActivate:o,onItemDeactivate:j.useCallback(()=>o(""),[o]),children:t.jsx(Le,{...s,ref:n})})}),kt=j.forwardRef((e,n)=>{const{value:a,defaultValue:i,onValueChange:r=()=>{},...s}=e,[l,o]=I({prop:a,defaultProp:i??[],onChange:r,caller:L}),c=j.useCallback(h=>o((u=[])=>[...u,h]),[o]),f=j.useCallback(h=>o((u=[])=>u.filter(p=>p!==h)),[o]);return t.jsx(we,{scope:e.__scopeToggleGroup,type:"multiple",value:l,onItemActivate:c,onItemDeactivate:f,children:t.jsx(Le,{...s,ref:n})})});K.displayName=L;var[St,Vt]=ye(L),Le=j.forwardRef((e,n)=>{const{__scopeToggleGroup:a,disabled:i=!1,rovingFocus:r=!0,orientation:s,dir:l,loop:o=!0,...c}=e,f=Pe(a),h=$e(l),u={role:"group",dir:h,...c};return t.jsx(St,{scope:a,rovingFocus:r,disabled:i,children:r?t.jsx(Ke,{asChild:!0,...f,orientation:s,dir:h,loop:o,children:t.jsx(T.div,{...u,ref:n})}):t.jsx(T.div,{...u,ref:n})})}),E="ToggleGroupItem",Me=j.forwardRef((e,n)=>{const a=Ne(E,e.__scopeToggleGroup),i=Vt(E,e.__scopeToggleGroup),r=Pe(e.__scopeToggleGroup),s=a.value.includes(e.value),l=i.disabled||e.disabled,o={...e,pressed:s,disabled:l},c=j.useRef(null);return i.rovingFocus?t.jsx(Ue,{asChild:!0,...r,focusable:!l,active:s,ref:c,children:t.jsx(ae,{...o,ref:n})}):t.jsx(ae,{...o,ref:n})});Me.displayName=E;var ae=j.forwardRef((e,n)=>{const{__scopeToggleGroup:a,value:i,...r}=e,s=Ne(E,a),l={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},o=s.type==="single"?l:void 0;return t.jsx(Ce,{...o,...r,ref:n,onPressedChange:c=>{c?s.onItemActivate(i):s.onItemDeactivate(i)}})}),Gt=K,Ot=Me;const zt=Je("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),_e=d.createContext({size:"default",variant:"default"});function Ht({className:e,variant:n,size:a,children:i,...r}){return t.jsx(Gt,{"data-slot":"toggle-group","data-variant":n,"data-size":a,className:_("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",e),...r,children:t.jsx(_e.Provider,{value:{variant:n,size:a},children:i})})}function ne({className:e,children:n,variant:a,size:i,...r}){const s=d.useContext(_e);return t.jsx(Ot,{"data-slot":"toggle-group-item","data-variant":s.variant||a,"data-size":s.size||i,className:_(zt({variant:s.variant||a,size:s.size||i}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l cursor-pointer",e),...r,children:n})}const qt=({multipleMetadata:e})=>{var h;const{chatId:n}=fe(),{dataSource:a,setDataSource:i}=F(),{data:r}=k(),{mutate:s}=Ye(),l=u=>{u&&(n&&s({chatId:n,dataSource:u}),i(u))},o=n&&((h=r==null?void 0:r.find(u=>u.id===n))==null?void 0:h.data_source)||a,c=d.useMemo(()=>e==null?void 0:e.reduce((u,{name:p,metadata:x})=>{const{data_source:g}=x;return o===b.FILE&&(g===b.FILE||g===b.CATALOG)&&u.push(p),o===b.DATABASE&&g===b.DATABASE&&u.push(p),u},[]),[e,o]),f=()=>t.jsxs("div",{className:"absolute min-w-[270px] max-w-[600px] left-1/2 -translate-x-1/2 top-full mb-2 hidden bg-secondary text-secondary-foreground group-hover:block text-xs rounded px-2 py-1 shadow z-10",children:["Selected data sources:",c&&(c==null?void 0:c.length)>0?t.jsx("ul",{className:"list-disc pl-5",children:c.map(u=>t.jsx("li",{className:"text-sm",children:u},u))}):t.jsx("div",{className:"text-sm",children:"No data sources selected."})]});return t.jsxs(Ht,{type:"single",value:o,onValueChange:l,className:"bg-muted rounded-md p-1 shadow-sm group relative",children:[f(),t.jsx(ne,{value:b.DATABASE,className:"text-sm",children:t.jsx("div",{className:"m-2",children:"Database"})}),t.jsx(ne,{value:b.FILE,className:"text-sm",children:t.jsx("div",{className:"m-2",children:"Registry / File"})})]})},se=d.lazy(()=>de(()=>import("./ResponseMessage-Bi-Z-iLQ.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url).then(e=>({default:e.ResponseMessage}))),R=()=>{const{t:e}=N();return t.jsx("div",{className:"p-4 text-sm",children:e("Loading component...")})},Bt=({message:e,messages:n,chatId:a,index:i})=>{var s;const r=(s=n[i+1])==null?void 0:s.id;return t.jsx("div",{className:"table table-fixed w-full",children:e.role==="user"?t.jsxs(t.Fragment,{children:[t.jsx(Tt,{id:e.id,responseId:r,message:e.content,timestamp:e.created_at,chatId:a}),e.in_progress&&t.jsx(d.Suspense,{fallback:t.jsx(R,{}),children:t.jsx(se,{message:e,isLoading:!0,chatId:a})})]}):t.jsx(d.Suspense,{fallback:t.jsx(R,{}),children:t.jsx(se,{message:e,isLoading:!1,chatId:a})})})},Zt=()=>{const{t:e}=N(),{chatId:n}=fe(),a=re(),[i,r]=d.useState(!1),{data:s=[],status:l}=Qe({chatId:n}),{data:o}=k(),c=o?o.find(v=>v.id===n):void 0,{mutate:f,isPending:h}=We({onSuccess:()=>{const v=(o==null?void 0:o.filter(y=>y.id!==(c==null?void 0:c.id)))||[];if(r(!1),v.length>0){const y=[...v].sort((P,J)=>{const Ae=P.created_at?new Date(P.created_at).getTime():0;return(J.created_at?new Date(J.created_at).getTime():0)-Ae});a(`/chats/${y[0].id}`)}else a(ie.CHATS)}}),u=!(s!=null&&s.some(v=>v.in_progress)),{data:p}=Xe(),{data:x}=at((p==null?void 0:p.map(v=>v.name))||[]),{hasMixedSources:g,allowedDataSources:m}=d.useMemo(()=>{if(!x)return{allowedDataSources:[],hasMixedSources:!1};const v=new Set;return x.forEach(({metadata:y})=>{const{data_source:P}=y;P===b.FILE||P===b.CATALOG?v.add(b.FILE):P===b.DATABASE&&v.add(b.DATABASE)}),{allowedDataSources:Array.from(v),hasMixedSources:v.has(b.FILE)&&v.has(b.DATABASE)}},[x]),D=()=>{c!=null&&c.id&&f({chatId:c.id})},M=()=>!s||s.length===0?t.jsx(d.Suspense,{fallback:t.jsx(R,{}),children:t.jsx(Nt,{allowedDataSources:m,chatId:c==null?void 0:c.id})}):t.jsxs(t.Fragment,{children:[t.jsx(st,{className:"flex flex-1 flex-col overflow-y-hidden pr-2 pb-4",children:s==null?void 0:s.map((v,y,P)=>t.jsx(Bt,{message:v,messages:P,chatId:c==null?void 0:c.id,index:y},y))}),t.jsx(d.Suspense,{fallback:t.jsx(R,{}),children:t.jsx(Dt,{allowedDataSources:m,chatId:c==null?void 0:c.id,allowSend:u})})]}),C=()=>c?t.jsxs(t.Fragment,{children:[t.jsx(ge,{open:i,isLoading:h,onOpenChange:r,title:e("Delete chat"),confirmText:e("Delete"),cancelText:e("Cancel"),description:e("Are you sure you want to delete this chat?"),onConfirm:D,variant:"destructive"}),t.jsxs("h2",{className:"text-xl flex-1",children:[t.jsx("strong",{children:c.name||e("New Chat")}),t.jsx(It,{chatId:c.id,currentName:c.name})]}),t.jsx("div",{children:g&&t.jsx(qt,{multipleMetadata:x})}),t.jsxs(A,{variant:"ghost",onClick:()=>tt(c.id),children:[t.jsx(w,{icon:it.faFileArrowDown}),t.jsx("span",{className:"ml-2",children:e("Export chat")})]}),t.jsxs(A,{variant:"ghost",onClick:()=>r(!0),testId:"delete-all-chats-button",children:[t.jsx(w,{icon:he.faTrash}),t.jsx("span",{className:"ml-2",children:e("Delete chat")})]})]}):null;return t.jsxs("div",{className:"p-6 h-full flex flex-col",children:[t.jsx("div",{className:"flex justify-between items-center gap-2 h-9",children:C()}),t.jsx(et,{className:"my-4 border-t"}),l==="pending"&&!(s!=null&&s.length)?t.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:t.jsx(nt,{})}):M()]})},ta=Object.freeze(Object.defineProperty({__proto__:null,Chats:Zt},Symbol.toStringTag,{value:"Module"}));export{yt as C,Jt as D,Qt as M,Wt as P,At as a,Lt as b,ta as c,be as f,Xt as p};
