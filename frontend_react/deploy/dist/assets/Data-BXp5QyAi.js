import{u as U,a as N,j as s,B as P,F as b,r as m,R as J,I as X,l as B,b as Y,c as Z,d as ee,e as se,f as _,D as y,g as ae,h as te,S as ne}from"./index-DBs3BIIJ.js";import{f as Q,u as ie,L as $,a as re,S as le}from"./loading-D7YKoSf6.js";import{T as K,a as H,b as S,c as T,d as W,e as C,f as ce,g as oe,h as de,i as F}from"./tabs-DCR4BHs9.js";const fe=({onClear:e})=>{const{mutate:n}=U(),{t:i}=N(),l=()=>{n(),e&&e()};return s.jsxs(P,{variant:"ghost",onClick:l,children:[s.jsx(b,{icon:Q.faTrash}),i("clear_all_datasets")]})};var R={},A;function ue(){return A||(A=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",i="download",l=512,c=512,a=[],r="f019",t="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 242.7-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7 288 32zM64 352c-35.3 0-64 28.7-64 64l0 32c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-32c0-35.3-28.7-64-64-64l-101.5 0-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352 64 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z";e.definition={prefix:n,iconName:i,icon:[l,c,a,r,t]},e.faDownload=e.definition,e.prefix=n,e.iconName=i,e.width=l,e.height=c,e.ligatures=a,e.unicode=r,e.svgPathData=t,e.aliases=a}(R)),R}var he=ue();const O=({initialValue:e,rowIndex:n,field:i,onUpdate:l})=>{const[c,a]=m.useState(!1),[r,t]=m.useState(e),{t:f}=N();J.useEffect(()=>{t(e)},[e]);const o=()=>{a(!0)},h=()=>{a(!1),r!==e&&l&&l(n,i,r)},v=u=>{u.key==="Enter"?(u.preventDefault(),a(!1),r!==e&&l&&l(n,i,r)):u.key==="Escape"&&(a(!1),t(e))};return c?s.jsx(X,{value:r,onChange:u=>t(u.target.value),onBlur:h,onKeyDown:v,autoFocus:!0,className:"w-full h-[28px]"}):s.jsx("div",{onDoubleClick:o,className:"cursor-pointer hover:bg-secondary p-1 rounded min-h-[28px]",title:f("double_click_edit"),children:r})},ge=({data:e,onUpdateCell:n})=>{var c;const{t:i}=N(),l=(a,r,t)=>{n&&n(a,r,t)};return s.jsxs(K,{children:[s.jsx(H,{className:"bg-background",children:s.jsxs(S,{children:[s.jsx(T,{className:"w-[200px]",children:i("column")}),s.jsx(T,{children:i("type")}),s.jsx(T,{children:i("description_col")})]})}),s.jsx(W,{children:(c=e.column_descriptions)==null?void 0:c.map((a,r)=>s.jsxs(S,{children:[s.jsx(C,{className:"font-medium",children:a.column}),s.jsx(C,{children:s.jsx(O,{initialValue:a.data_type,rowIndex:r,field:"data_type",onUpdate:l})}),s.jsx(C,{children:s.jsx(O,{initialValue:a.description,rowIndex:r,field:"description",onUpdate:l})})]},a.column))})]})};var L=new Map,M=new WeakMap,G=0,xe=void 0;function me(e){return e?(M.has(e)||(G+=1,M.set(e,G.toString())),M.get(e)):"0"}function ve(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?me(e.root):e[n]}`).toString()}function je(e){const n=ve(e);let i=L.get(n);if(!i){const l=new Map;let c;const a=new IntersectionObserver(r=>{r.forEach(t=>{var f;const o=t.isIntersecting&&c.some(h=>t.intersectionRatio>=h);e.trackVisibility&&typeof t.isVisible>"u"&&(t.isVisible=o),(f=l.get(t.target))==null||f.forEach(h=>{h(o,t)})})},e);c=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:n,observer:a,elements:l},L.set(n,i)}return i}function Ne(e,n,i={},l=xe){if(typeof window.IntersectionObserver>"u"&&l!==void 0){const f=e.getBoundingClientRect();return n(l,{isIntersecting:l,target:e,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:f,intersectionRect:f,rootBounds:f}),()=>{}}const{id:c,observer:a,elements:r}=je(i),t=r.get(e)||[];return r.has(e)||r.set(e,t),t.push(n),a.observe(e),function(){t.splice(t.indexOf(n),1),t.length===0&&(r.delete(e),a.unobserve(e)),r.size===0&&(a.disconnect(),L.delete(c))}}function we({threshold:e,delay:n,trackVisibility:i,rootMargin:l,root:c,triggerOnce:a,skip:r,initialInView:t,fallbackInView:f,onChange:o}={}){var h;const[v,u]=m.useState(null),j=m.useRef(o),[d,g]=m.useState({inView:!!t,entry:void 0});j.current=o,m.useEffect(()=>{if(r||!v)return;let p;return p=Ne(v,(k,E)=>{g({inView:k,entry:E}),j.current&&j.current(k,E),E.isIntersecting&&a&&p&&(p(),p=void 0)},{root:c,rootMargin:l,threshold:e,trackVisibility:i,delay:n},f),()=>{p&&p()}},[Array.isArray(e)?e.toString():e,v,c,l,a,r,i,f,n]);const x=(h=d.entry)==null?void 0:h.target,D=m.useRef(void 0);!v&&x&&!a&&!r&&D.current!==x&&(D.current=x,g({inView:!!t,entry:void 0}));const w=[u,d.inView,d.entry];return w.ref=w[0],w.inView=w[1],w.entry=w[2],w}const be=({datasetName:e,rowsPerPage:n=50})=>{const{ref:i,inView:l}=we(),{t:c}=N(),{data:a,fetchNextPage:r,hasNextPage:t,isFetchingNextPage:f,status:o,isError:h,error:v}=ie(e,n);m.useEffect(()=>{l&&t&&!f&&r()},[l,r,t,f]);const u=m.useMemo(()=>a?a.pages.flatMap(d=>d.dataset.data_records):[],[a]),j=m.useMemo(()=>{var d,g;return!a||!((g=(d=a.pages[0])==null?void 0:d.dataset)!=null&&g.data_records[0])?[]:Object.keys(a.pages[0].dataset.data_records[0])},[a]);return o==="pending"?s.jsx("div",{className:"h-96",children:s.jsx($,{})}):h?s.jsxs("div",{className:"flex flex-col flex-1 items-center justify-center h-96",children:[c("error_loading_data")," ",String(v)]}):u.length===0?s.jsx("div",{className:"flex flex-col flex-1 items-center justify-center h-96",children:c("no_data_available")}):s.jsxs("div",{className:"w-full overflow-auto",children:[s.jsxs(K,{children:[s.jsx(H,{className:"bg-background",children:s.jsx(S,{children:j.map(d=>s.jsx(T,{children:d},d))})}),s.jsx(W,{children:u.map((d,g)=>s.jsx(S,{children:j.map(x=>s.jsx(C,{children:d[x]!==null&&d[x]!==void 0?String(d[x]):""},x))},g))})]}),s.jsx("div",{ref:i,className:"w-full text-center p-4",children:f?s.jsxs("div",{className:"flex justify-center items-center",children:[s.jsx("img",{src:B,alt:c("processing"),className:"mr-2 w-4 h-4 animate-spin"}),s.jsx("span",{className:"ml-2",children:c("loading")})]}):t?s.jsx("div",{className:"h-10"}):s.jsx("div",{className:"text-muted-foreground",children:u.length>0?c("end_of_data"):c("no_data")})})]})},pe=({dictionary:e,isProcessing:n=!0,viewMode:i="description"})=>{var u,j;const{mutate:l}=Y(),{mutate:c}=Z(),{mutate:a,isPending:r}=ee(),{data:t,isLoading:f}=re(e.name),{t:o}=N(),h=d=>{if(d===0)return"0 Bytes";const g=1024,x=[o("file_size_bytes","Bytes"),o("file_size_kb","KB"),o("file_size_mb","MB"),o("file_size_gb","GB"),o("file_size_tb","TB")],D=Math.floor(Math.log(d)/Math.log(g));return parseFloat((d/Math.pow(g,D)).toFixed(2))+" "+x[D]},v=t!=null&&t.file_size?h(t.file_size):"0 MB";return s.jsxs("div",{className:se("flex flex-col w-full bg-card p-4",{"h-[400px]":n}),children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg",children:s.jsx("strong",{children:e.name})}),s.jsxs("div",{className:"flex justify-between pt-1",children:[s.jsxs("div",{className:"flex gap-2 my-1",children:[s.jsx(_,{variant:"secondary",className:"leading-tight text-sm",children:f?o("loading"):`${((u=t==null?void 0:t.columns)==null?void 0:u.length)||0} ${o("features")}`}),s.jsx(_,{variant:"secondary",className:"leading-tight text-sm",children:f?o("loading"):`${((j=t==null?void 0:t.row_count)==null?void 0:j.toLocaleString())||0} ${o("rows")}`}),s.jsx(_,{variant:"secondary",className:"leading-tight text-sm",children:f?o("loading"):v}),s.jsx(_,{variant:"secondary",className:"leading-tight text-sm",children:(t==null?void 0:t.data_source)||o("file")}),n?s.jsxs(_,{variant:"outline",className:"leading-tight text-sm",children:[s.jsx("img",{src:B,alt:o("processing"),className:"mr-2 w-4 h-4 animate-spin"}),o("processing")]}):s.jsxs(_,{variant:"success",className:"leading-tight text-sm",children:[s.jsx(b,{className:"mr-2 w-4 h-4 ",icon:ce.faCheck}),o("processed")]})]}),s.jsxs("div",{className:"flex gap-2 px-2",children:[s.jsx(P,{variant:"link",onClick:()=>{a({name:e.name})},title:o("download_dictionary_csv"),disabled:n||r,children:r?s.jsx("img",{src:B,alt:o("loading"),className:"w-4 h-4 animate-spin"}):s.jsx(b,{icon:he.faDownload})}),s.jsx(P,{variant:"link",onClick:()=>{l({name:e.name})},title:o("delete_dictionary"),children:s.jsx(b,{icon:Q.faTrash})})]})]})]}),s.jsx("div",{className:"flex flex-col flex-1 text-lg",children:n?s.jsx("div",{className:"flex flex-col flex-1 items-center justify-center",children:o("processing_dataset")}):s.jsx(le,{className:"mt-4 h-96",children:i===y.DESCRIPTION?s.jsx(ge,{data:e,onUpdateCell:(d,g,x)=>{c({name:e.name,rowIndex:d,field:g,value:x},{onError:()=>{}})}}):s.jsx(be,{datasetName:e.name,rowsPerPage:50})})})]})};var I={},q;function _e(){return q||(q=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",i="quote-left",l=448,c=512,a=[8220,"quote-left-alt"],r="f10d",t="M0 216C0 149.7 53.7 96 120 96l8 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-8 0c-30.9 0-56 25.1-56 56l0 8 64 0c35.3 0 64 28.7 64 64l0 64c0 35.3-28.7 64-64 64l-64 0c-35.3 0-64-28.7-64-64l0-32 0-32 0-72zm256 0c0-66.3 53.7-120 120-120l8 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-8 0c-30.9 0-56 25.1-56 56l0 8 64 0c35.3 0 64 28.7 64 64l0 64c0 35.3-28.7 64-64 64l-64 0c-35.3 0-64-28.7-64-64l0-32 0-32 0-72z";e.definition={prefix:n,iconName:i,icon:[l,c,a,r,t]},e.faQuoteLeft=e.definition,e.prefix=n,e.iconName=i,e.width=l,e.height=c,e.ligatures=a,e.unicode=r,e.svgPathData=t,e.aliases=a}(I)),I}var De=_e();const ye=({defaultValue:e=y.DESCRIPTION,onChange:n})=>{const{t:i}=N();return s.jsx(oe,{defaultValue:e,onValueChange:n,className:"w-fit py-4",children:s.jsxs(de,{className:"grid w-full grid-cols-2",children:[s.jsxs(F,{value:y.DESCRIPTION,children:[s.jsx(b,{className:"mr-2",icon:De.faQuoteLeft}),i("description")]}),s.jsxs(F,{value:y.RAW,children:[s.jsx(b,{className:"mr-2",icon:ae.faTable}),i("raw_rows")]})]})})};var z={},V;function Me(){return V||(V=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="fas",i="magnifying-glass",l=512,c=512,a=[128269,"search"],r="f002",t="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z";e.definition={prefix:n,iconName:i,icon:[l,c,a,r,t]},e.faMagnifyingGlass=e.definition,e.prefix=n,e.iconName=i,e.width=l,e.height=c,e.ligatures=a,e.unicode=r,e.svgPathData=t,e.aliases=a}(z)),z}var Te=Me();const Ce=()=>{const{t:e}=N();return s.jsxs("div",{children:[s.jsx(b,{className:"mx-2",icon:Te.faMagnifyingGlass}),e("search")]})},Ie=()=>{const{data:e,status:n}=te(),[i,l]=m.useState(y.DESCRIPTION),{t:c}=N();return s.jsxs("div",{className:"p-6",children:[s.jsx("h2",{className:"text-xl",children:s.jsx("strong",{children:c("data")})}),s.jsxs("div",{className:"flex justify-between gap-2",children:[s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("div",{className:"text-sm",children:c("view")}),s.jsx(ye,{defaultValue:i,onChange:a=>l(a)}),s.jsx(Ce,{})]}),s.jsx("div",{className:"flex items-center",children:s.jsx(fe,{})})]}),s.jsx(ne,{className:"my-4 border-t"}),n==="pending"?s.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:s.jsx($,{})}):s.jsx("div",{className:"flex flex-col gap-4",children:e==null?void 0:e.map(a=>s.jsx(pe,{isProcessing:a.in_progress||!1,dictionary:a,viewMode:i},a.name))})]})};export{Ie as Data};
